# environment-bench

Benchmarks for dictionaries keyed by a small number (<= 20) of consecutive
integers where 0 maps to the most recently added element, as typically used in
De Bruijn-indexed environments in compilers.

* `extension/n`: Create an environment by extending it n times
* `lookup/n`: Lookup up all variables [0..n - 1] in an environment of size n
* `combined/n`: Create an environment of size n and lookup all variables

## TL;DR:

Lists win in the combined benchmark up to around 15 elements when
`Data.IntMap`s take the lead.

## Full results:

```
combined/1/Data.List                     mean 24.50 ns  ( +- 316.7 ps  )
combined/1/Data.Vector                   mean 50.35 ns  ( +- 451.5 ps  )
combined/1/Data.Map                      mean 25.41 ns  ( +- 309.4 ps  )
combined/1/Data.IntMap                   mean 27.27 ns  ( +- 298.0 ps  )
combined/1/Data.HashMap.Lazy             mean 28.57 ns  ( +- 266.1 ps  )
combined/1/Data.Sequence                 mean 26.47 ns  ( +- 190.3 ps  )
combined/3/Data.List                     mean 78.40 ns  ( +- 856.8 ps  )
combined/3/Data.Vector                   mean 158.1 ns  ( +- 4.491 ns  )
combined/3/Data.Map                      mean 114.6 ns  ( +- 4.684 ns  )
combined/3/Data.IntMap                   mean 95.91 ns  ( +- 5.387 ns  )
combined/3/Data.HashMap.Lazy             mean 161.6 ns  ( +- 1.098 ns  )
combined/3/Data.Sequence                 mean 77.51 ns  ( +- 722.5 ps  )
combined/5/Data.List                     mean 152.7 ns  ( +- 1.027 ns  )
combined/5/Data.Vector                   mean 240.7 ns  ( +- 5.715 ns  )
combined/5/Data.Map                      mean 224.3 ns  ( +- 1.634 ns  )
combined/5/Data.IntMap                   mean 167.3 ns  ( +- 6.156 ns  )
combined/5/Data.HashMap.Lazy             mean 312.0 ns  ( +- 2.751 ns  )
combined/5/Data.Sequence                 mean 131.9 ns  ( +- 1.122 ns  )
combined/7/Data.List                     mean 236.2 ns  ( +- 1.400 ns  )
combined/7/Data.Vector                   mean 332.9 ns  ( +- 12.63 ns  )
combined/7/Data.Map                      mean 359.1 ns  ( +- 2.939 ns  )
combined/7/Data.IntMap                   mean 257.2 ns  ( +- 10.58 ns  )
combined/7/Data.HashMap.Lazy             mean 418.6 ns  ( +- 2.381 ns  )
combined/7/Data.Sequence                 mean 265.1 ns  ( +- 12.87 ns  )
combined/10/Data.List                    mean 377.0 ns  ( +- 1.478 ns  )
combined/10/Data.Vector                  mean 460.1 ns  ( +- 10.38 ns  )
combined/10/Data.Map                     mean 574.1 ns  ( +- 5.768 ns  )
combined/10/Data.IntMap                  mean 422.1 ns  ( +- 26.54 ns  )
combined/10/Data.HashMap.Lazy            mean 591.5 ns  ( +- 2.860 ns  )
combined/10/Data.Sequence                mean 400.5 ns  ( +- 3.463 ns  )
combined/15/Data.List                    mean 654.6 ns  ( +- 2.914 ns  )
combined/15/Data.Vector                  mean 711.8 ns  ( +- 14.65 ns  )
combined/15/Data.Map                     mean 989.8 ns  ( +- 16.08 ns  )
combined/15/Data.IntMap                  mean 639.9 ns  ( +- 29.74 ns  )
combined/15/Data.HashMap.Lazy            mean 923.4 ns  ( +- 6.456 ns  )
combined/15/Data.Sequence                mean 754.1 ns  ( +- 9.176 ns  )
combined/20/Data.List                    mean 992.5 ns  ( +- 4.969 ns  )
combined/20/Data.Vector                  mean 989.9 ns  ( +- 43.11 ns  )
combined/20/Data.Map                     mean 1.500 μs  ( +- 18.16 ns  )
combined/20/Data.IntMap                  mean 906.0 ns  ( +- 57.46 ns  )
combined/20/Data.HashMap.Lazy            mean 1.294 μs  ( +- 7.693 ns  )
combined/20/Data.Sequence                mean 1.083 μs  ( +- 14.23 ns  )
extension/1/Data.List                    mean 8.530 ns  ( +- 89.60 ps  )
extension/1/Data.Vector                  mean 31.39 ns  ( +- 1.208 ns  )
extension/1/Data.Map                     mean 21.16 ns  ( +- 353.1 ps  )
extension/1/Data.IntMap                  mean 18.99 ns  ( +- 187.9 ps  )
extension/1/Data.HashMap.Lazy            mean 21.69 ns  ( +- 361.3 ps  )
extension/1/Data.Sequence                mean 12.95 ns  ( +- 580.1 ps  )
extension/3/Data.List                    mean 10.34 ns  ( +- 224.8 ps  )
extension/3/Data.Vector                  mean 102.9 ns  ( +- 965.3 ps  )
extension/3/Data.Map                     mean 99.49 ns  ( +- 934.4 ps  )
extension/3/Data.IntMap                  mean 63.83 ns  ( +- 529.3 ps  )
extension/3/Data.HashMap.Lazy            mean 102.4 ns  ( +- 860.1 ps  )
extension/3/Data.Sequence                mean 31.32 ns  ( +- 517.8 ps  )
extension/5/Data.List                    mean 13.13 ns  ( +- 195.4 ps  )
extension/5/Data.Vector                  mean 170.9 ns  ( +- 1.241 ns  )
extension/5/Data.Map                     mean 189.7 ns  ( +- 1.211 ns  )
extension/5/Data.IntMap                  mean 103.6 ns  ( +- 2.405 ns  )
extension/5/Data.HashMap.Lazy            mean 211.5 ns  ( +- 1.752 ns  )
extension/5/Data.Sequence                mean 45.97 ns  ( +- 978.4 ps  )
extension/7/Data.List                    mean 15.01 ns  ( +- 143.9 ps  )
extension/7/Data.Vector                  mean 231.8 ns  ( +- 4.485 ns  )
extension/7/Data.Map                     mean 302.7 ns  ( +- 5.562 ns  )
extension/7/Data.IntMap                  mean 164.5 ns  ( +- 3.712 ns  )
extension/7/Data.HashMap.Lazy            mean 306.9 ns  ( +- 3.190 ns  )
extension/7/Data.Sequence                mean 81.33 ns  ( +- 5.929 ns  )
extension/10/Data.List                   mean 20.61 ns  ( +- 234.4 ps  )
extension/10/Data.Vector                 mean 344.1 ns  ( +- 2.606 ns  )
extension/10/Data.Map                    mean 479.7 ns  ( +- 5.555 ns  )
extension/10/Data.IntMap                 mean 245.8 ns  ( +- 2.553 ns  )
extension/10/Data.HashMap.Lazy           mean 436.2 ns  ( +- 4.656 ns  )
extension/10/Data.Sequence               mean 129.9 ns  ( +- 2.592 ns  )
extension/15/Data.List                   mean 52.18 ns  ( +- 885.7 ps  )
extension/15/Data.Vector                 mean 554.3 ns  ( +- 12.22 ns  )
extension/15/Data.Map                    mean 813.5 ns  ( +- 17.88 ns  )
extension/15/Data.IntMap                 mean 382.6 ns  ( +- 4.914 ns  )
extension/15/Data.HashMap.Lazy           mean 685.1 ns  ( +- 3.875 ns  )
extension/15/Data.Sequence               mean 215.1 ns  ( +- 2.614 ns  )
extension/20/Data.List                   mean 65.31 ns  ( +- 451.3 ps  )
extension/20/Data.Vector                 mean 777.1 ns  ( +- 5.947 ns  )
extension/20/Data.Map                    mean 1.200 μs  ( +- 13.50 ns  )
extension/20/Data.IntMap                 mean 530.2 ns  ( +- 6.862 ns  )
extension/20/Data.HashMap.Lazy           mean 990.9 ns  ( +- 7.899 ns  )
extension/20/Data.Sequence               mean 302.0 ns  ( +- 3.612 ns  )
lookup/1/Data.List                       mean 20.80 ns  ( +- 284.4 ps  )
lookup/1/Data.Vector                     mean 18.48 ns  ( +- 203.5 ps  )
lookup/1/Data.Map                        mean 21.96 ns  ( +- 2.051 ns  )
lookup/1/Data.IntMap                     mean 23.00 ns  ( +- 212.3 ps  )
lookup/1/Data.HashMap.Lazy               mean 23.53 ns  ( +- 200.2 ps  )
lookup/1/Data.Sequence                   mean 21.91 ns  ( +- 286.6 ps  )
lookup/3/Data.List                       mean 47.08 ns  ( +- 348.1 ps  )
lookup/3/Data.Vector                     mean 38.00 ns  ( +- 431.2 ps  )
lookup/3/Data.Map                        mean 51.77 ns  ( +- 506.6 ps  )
lookup/3/Data.IntMap                     mean 53.42 ns  ( +- 835.0 ps  )
lookup/3/Data.HashMap.Lazy               mean 71.86 ns  ( +- 795.9 ps  )
lookup/3/Data.Sequence                   mean 56.52 ns  ( +- 412.3 ps  )
lookup/5/Data.List                       mean 77.63 ns  ( +- 800.3 ps  )
lookup/5/Data.Vector                     mean 62.64 ns  ( +- 917.1 ps  )
lookup/5/Data.Map                        mean 85.74 ns  ( +- 727.5 ps  )
lookup/5/Data.IntMap                     mean 94.23 ns  ( +- 651.4 ps  )
lookup/5/Data.HashMap.Lazy               mean 104.2 ns  ( +- 2.017 ns  )
lookup/5/Data.Sequence                   mean 92.88 ns  ( +- 505.5 ps  )
lookup/7/Data.List                       mean 128.7 ns  ( +- 1.091 ns  )
lookup/7/Data.Vector                     mean 80.01 ns  ( +- 621.9 ps  )
lookup/7/Data.Map                        mean 120.8 ns  ( +- 814.8 ps  )
lookup/7/Data.IntMap                     mean 134.9 ns  ( +- 4.335 ns  )
lookup/7/Data.HashMap.Lazy               mean 137.7 ns  ( +- 1.330 ns  )
lookup/7/Data.Sequence                   mean 138.4 ns  ( +- 3.128 ns  )
lookup/10/Data.List                      mean 216.0 ns  ( +- 3.736 ns  )
lookup/10/Data.Vector                    mean 110.2 ns  ( +- 4.423 ns  )
lookup/10/Data.Map                       mean 177.2 ns  ( +- 1.246 ns  )
lookup/10/Data.IntMap                    mean 186.6 ns  ( +- 3.855 ns  )
lookup/10/Data.HashMap.Lazy              mean 193.4 ns  ( +- 3.684 ns  )
lookup/10/Data.Sequence                  mean 219.0 ns  ( +- 1.745 ns  )
lookup/15/Data.List                      mean 432.8 ns  ( +- 3.203 ns  )
lookup/15/Data.Vector                    mean 160.7 ns  ( +- 9.121 ns  )
lookup/15/Data.Map                       mean 282.7 ns  ( +- 1.768 ns  )
lookup/15/Data.IntMap                    mean 307.5 ns  ( +- 4.132 ns  )
lookup/15/Data.HashMap.Lazy              mean 280.7 ns  ( +- 5.237 ns  )
lookup/15/Data.Sequence                  mean 528.5 ns  ( +- 5.503 ns  )
lookup/20/Data.List                      mean 697.5 ns  ( +- 3.478 ns  )
lookup/20/Data.Vector                    mean 199.2 ns  ( +- 4.321 ns  )
lookup/20/Data.Map                       mean 404.4 ns  ( +- 3.396 ns  )
lookup/20/Data.IntMap                    mean 438.1 ns  ( +- 3.649 ns  )
lookup/20/Data.HashMap.Lazy              mean 386.6 ns  ( +- 4.030 ns  )
lookup/20/Data.Sequence                  mean 761.7 ns  ( +- 5.611 ns  )

```
